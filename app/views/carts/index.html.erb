<h4><%= link_to 'Back to Products', root_path %></h4><br>
<h4 style = color:red>Cart Details</h4><br>

<table class="table table-bordered">
  <tr>
    <th>CompanyName</th>
    <th>Description</th>
    <th>Price</th>
    <th>Quantity</th>
    <th>Total</th>
    <th>Remove</th>
  </tr>
  <body>
    <% @cart.cart_items.each do |cart_item| %>
      <tr>
        <% if cart_item.sub_product.id.present? %>
          <td><%= cart_item.sub_product.company_name%></td>
          <td><%= cart_item.sub_product.description%></td>
          <td><%= cart_item.sub_product.price%></td>
        <% end %>
          <td>
            <%= form_with model: cart_item, url: cart_item_path(cart_item.id), local: true do |f| %>
              <%= f.number_field :quantity, value: cart_item.quantity, min: 1 %>
              <%= f.submit 'Update' %>
            <% end %>
          </td>
        <td><%= cart_item.total %></td>
        <td>
        <%= link_to 'Remove', cart_item_path(cart_item.id),
                    method: :delete,
                    data: { confirm: 'Are you sure?' } %>
        </td>
      </tr>
    <% end %>
    <tr>
      <td colspan="4" class="text-right"><strong>Grand Total:</strong></td>
      <td><%= @cart.calculate_grand_total %></td>
    </tr>
  </body>
</table>
<%= form_with model: @cart, url: cart_path(@cart), local: true do |f| %>
  <div class="actions">
    <%= f.submit 'Buy Now' %>
  </div>
<% end %>
